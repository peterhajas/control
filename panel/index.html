<html>
    <head>
    <script>
        var address = "ADDRESS"; // this will be replaced when served for /index by control.py
        var host = "http://" + address + ":8080";
        var refresh_interval = 1800; // 30 minutes seems reasonable
    </script>
    <link rel="stylesheet" type="text/css" href="style.css">
    <title>Control</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
    </head>

    <body>
    <script>
        var address = host + "/allBulbNames";
        $("#loading").removeClass("hidden");
        $.get(address,
              function(data) {
                  var bulbs = data.split("\n");
                  for (var i in bulbs) {
                      var bulbName = bulbs[i];
                      console.log(bulbName);
                      var bulbElement = $('<li class=bulbListItem></li>');
                      bulbElement.text(bulbName);
                      bulbElement.prop('id', bulbName);

                      $(bulbElement).click(function() {
                          var name = $(this).attr('id');
                          var getAddress = host + "/toggle/" + name;
                          $.get(getAddress);
                      });

                      console.log(bulbElement);
                      $("#bulbContainer").append(bulbElement);
                  }
                $("#loadingContainer").addClass("hidden");
              }
          );

          setInterval(function() {
            location.reload();
          }, refresh_interval * 1000);
    </script>

    <div id="bulbContainer">
    </div>

    <div id="loadingContainer">
		<div id="loadingText">
			Loading...
		</div>
    </div>

    </body>
</html>
